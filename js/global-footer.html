<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KV3TTSJ" height="0" width="0"
    style="display: none; visibility: hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->

<script>
  $(function () {
    //document ready
    if (document.querySelector("#local-navbar-container")) {
      const locale_prepend =
        document.getElementsByTagName("html")[0].getAttribute("lang") == "es"
          ? "/es"
          : "";
      const local_home = `${locale_prepend}${$("#local-logo-link").attr(
        "nav-link-to"
      )}`;
      $("#local-logo-link").attr("href", local_home);
      $("[nav-link-to]")
        .not("#local-logo-link")
        .each(function () {
          let linkto = $(this).attr("nav-link-to");
          if ($(this).attr("query-param-value")) {
            linkto += `?${$(this).attr("query-param-key")}=${encodeURIComponent(
              $(this).attr("query-param-value")
            )}`;
          }
          $(this).attr("href", `${local_home}/${linkto}`);
        });
    }

    let current_path = window.location.pathname;
    $(`a[href='${current_path}']`).addClass("active-url");
  });
</script>

<script>
  var scrollPositionNavSafeVarName = 0;
  $(function () {
    const targetNode = document.querySelector(".w-nav-overlay");
    if (targetNode) {
      const observer = new MutationObserver((mutationsList) => {
        for (const mutation of mutationsList) {
          if (
            mutation.type === "attributes" &&
            mutation.attributeName === "style"
          ) {
            const displayStyle = mutation.target.style.display;
            if (displayStyle === "block") {
              scrollPositionNavSafeVarName = window.scrollY;
              setTimeout(function () {
                $("body").addClass("no-scroll");
              }, 500);
            } else {
              $("body").removeClass("no-scroll");
              window.scrollTo(0, parseInt(scrollPositionNavSafeVarName, 10));
            }
          }
        }
      });

      const config = { attributes: true, attributeFilter: ["style"] };
      observer.observe(targetNode, config);
    } else {
      console.log("Element with class .w-nav-overlay not found");
    }
  });
</script>

<script>
  // ðŸ¦·Homepage logo link's ARIA attributes
  document.addEventListener("DOMContentLoaded", function () {
    const logoLink = document.querySelector(".nav-company-logo");
    if (logoLink) {
      logoLink.removeAttribute("aria-current");
      logoLink.setAttribute(
        "aria-label",
        "home, graphic, Ideal Dental logo, established 2008"
      );
    }
  });
</script>

<script>
  // ðŸ¦· Footer logo link's ARIA attributes
  document.addEventListener("DOMContentLoaded", function () {
    const footerLogo = document.querySelector(".ideal-dental-footer-logo");

    if (footerLogo) {
      footerLogo.removeAttribute("aria-current");

      footerLogo.setAttribute(
        "aria-label",
        "footer, graphic, Ideal Dental logo, established 2008"
      );

      if (!footerLogo.hasAttribute("tabindex")) {
        footerLogo.setAttribute("tabindex", "0");
      }
    }
  });
</script>

<script>
  // ðŸ¦· Scroll-to-top ARIA fix for all pages
  document.addEventListener("DOMContentLoaded", function () {
    function setScrollButtonAttributes() {
      const scrollBlock = document.querySelector(".scroll-to-top");
      if (scrollBlock) {
        scrollBlock.setAttribute("role", "button");
        scrollBlock.setAttribute("aria-label", "Button, back to top");
        if (!scrollBlock.hasAttribute("tabindex")) {
          scrollBlock.setAttribute("tabindex", "0");
        }
        return true;
      }
      return false;
    }

    const intervalId = setInterval(function () {
      if (setScrollButtonAttributes()) {
        clearInterval(intervalId);
      }
    }, 500);
  });
</script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    // Ideal Dental Plan Logo
    const idealPlanLogo = document.querySelector(".ideal-dental-plan-logo");
    if (idealPlanLogo) {
      idealPlanLogo.removeAttribute("aria-current");
      idealPlanLogo.setAttribute("alt", "Graphic, Ideal Dental Plan");
      idealPlanLogo.setAttribute("aria-label", "Graphic, Ideal Dental Plan");
      if (!idealPlanLogo.hasAttribute("tabindex")) {
        idealPlanLogo.setAttribute("tabindex", "0");
      }
    }

    // CareCredit Plan Logo
    const careCreditLogo = document.querySelector(".care-credit-plan-logo");
    if (careCreditLogo) {
      careCreditLogo.removeAttribute("aria-current");
      careCreditLogo.setAttribute("alt", "Graphic, CareCredit Plan Logo");
      careCreditLogo.setAttribute(
        "aria-label",
        "Graphic, CareCredit Plan Logo"
      );
      if (!careCreditLogo.hasAttribute("tabindex")) {
        careCreditLogo.setAttribute("tabindex", "0");
      }
    }
  });
</script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const ratingWrapper = document.querySelector(".rating-stars");
    if (ratingWrapper) {
      // Hide each individual SVG star from accessibility so they arenâ€™t read separately
      const stars = ratingWrapper.querySelectorAll("svg.rating-star");
      stars.forEach(function (star) {
        star.setAttribute("aria-hidden", "true");
      });
    }
  });

</script>







<!--
NEW CODE ADDED BY AKSHAY
Purpose: To prevent recursive self-embeds and heavy duplicate asset loads.
-->
<script>
  (function () {
    function removeNestedIframes() {
      // Run only when this document itself is inside an iframe
      let inFrame = true;
      try { inFrame = window.self !== window.top; } catch (_) { inFrame = true; }
      if (!inFrame) return;

      function kill(nodeListOrArray) {
        for (const el of nodeListOrArray) {
          try {
            if (el.contentWindow && typeof el.contentWindow.stop === 'function') {
              el.contentWindow.stop(); // cancel if already loading (same-origin)
            }
          } catch (_) { }
          try {
            el.removeAttribute('src');
            el.removeAttribute('srcdoc');
          } catch (_) { }
          if (el.parentNode) el.parentNode.removeChild(el);
        }
      }

      // Remove any iframes already in the DOM
      kill(document.querySelectorAll('iframe'));

      // Watch for future iframes or src changes and remove them immediately
      const mo = new MutationObserver((mutations) => {
        for (const m of mutations) {
          // Handle newly added nodes
          if (m.addedNodes && m.addedNodes.length) {
            for (const node of m.addedNodes) {
              if (node && node.nodeType === 1) { // element nodes only
                if (node.tagName && node.tagName.toLowerCase() === 'iframe') {
                  kill([node]);
                } else if (node.querySelectorAll) {
                  const innerIframes = node.querySelectorAll('iframe');
                  if (innerIframes.length) kill(innerIframes);
                }
              }
            }
          }
          // If an existing iframe's src changes, remove it
          if (
            m.type === 'attributes' &&
            m.attributeName === 'src' &&
            m.target &&
            m.target.tagName &&
            m.target.tagName.toLowerCase() === 'iframe'
          ) {
            kill([m.target]);
          }
        }
      });

      mo.observe(document.documentElement, {
        childList: true,
        subtree: true,
        attributes: true,
        attributeFilter: ['src']
      });
    }

    // Run ASAP
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', removeNestedIframes, { once: true });
    } else {
      removeNestedIframes();
    }
  })();
</script>